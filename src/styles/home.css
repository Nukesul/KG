@import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&display=swap");

:root{
  --primary:#e32636;
  --accent:#ffd700;
  --white:#fff;

  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);

  --app-vh: 100vh;
  --bar-h: 92px;
  --radius: 18px;

  --sky: rgba(80, 170, 255, .22);
  --sun: rgba(255, 200, 80, .22);
  --rose: rgba(255, 90, 140, .16);
  --mint: rgba(60, 255, 200, .14);

  --stroke-soft: rgba(255,255,255,.22);
  --shadow: 0 18px 46px rgba(0,0,0,.18);

  --text: rgba(255,255,255,.95);
  --text-soft: rgba(255,255,255,.88);

  --btn: rgba(255,255,255,.14);
  --btn-hover: rgba(255,255,255,.22);

  --overlay-alpha-strong: 0.07;
  --overlay-alpha-weak: 0.035;
}

.fs-shell.t1 { --a1: var(--sun);  --a2: rgba(255,215,0,.16);  --prog: rgba(255,215,0,.70); }
.fs-shell.t2 { --a1: var(--sky);  --a2: var(--mint);          --prog: rgba(80,170,255,.70); }
.fs-shell.t3 { --a1: rgba(160,90,255,.16); --a2: rgba(255,150,0,.16); --prog: rgba(160,90,255,.70); }
.fs-shell.t4 { --a1: var(--rose); --a2: rgba(0,200,255,.14);  --prog: rgba(255,90,140,.70); }

*{ margin:0; padding:0; box-sizing:border-box; }
html,body{ height:100%; }

body{
  font-family:"Montserrat", system-ui, -apple-system, sans-serif;
  background:#000;
  color:var(--text);
  overflow:hidden;
}

.fs-shell{
  position:relative;
  width:100vw;
  height:var(--app-vh);
  height:100svh;
  overflow:hidden;
}

/* Video */
.video-layer{ position:absolute; inset:0; }
.hero-video{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
}

/* overlay */
.overlay{ position:absolute; inset:0; pointer-events:none; transition: opacity .18s ease; }
.overlay-strong{
  opacity: 1;
  background:
    radial-gradient(900px 620px at 18% 18%, var(--a1), transparent 62%),
    radial-gradient(900px 720px at 84% 78%, var(--a2), transparent 66%),
    linear-gradient(to bottom,
      rgba(255,255,255,var(--overlay-alpha-strong)),
      rgba(255,255,255,0) 50%,
      rgba(0,0,0,0) 100%
    );
}
.overlay-weak{
  opacity: 1;
  background:
    radial-gradient(900px 620px at 18% 18%, rgba(255,255,255,var(--overlay-alpha-weak)), transparent 60%),
    radial-gradient(900px 720px at 84% 78%, rgba(255,255,255,var(--overlay-alpha-weak)), transparent 64%);
}
.overlay-cinema{ opacity:0 !important; }

.vignette{
  position:absolute;
  inset:0;
  pointer-events:none;
  transition: opacity .18s ease;
  background: radial-gradient(circle at 50% 45%, transparent 66%, rgba(0,0,0,.18));
}
.vignette-cinema{ opacity:0; }

.grain{
  position:absolute;
  inset:-20%;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.75' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.14'/%3E%3C/svg%3E");
  mix-blend-mode: soft-light;
  opacity:.03;
  pointer-events:none;
  transform: translateZ(0);
  animation: grainMove 10s steps(10) infinite;
}
@keyframes grainMove{
  0%,100%{ transform:translate3d(0,0,0); }
  25%{ transform:translate3d(-2%,1%,0); }
  50%{ transform:translate3d(-1%,-2%,0); }
  75%{ transform:translate3d(2%,1%,0); }
}

/* Header */
.header{
  position:fixed;
  top:0; left:0; right:0;
  padding-top: var(--safe-top);
  height: clamp(60px, 10vh, 86px);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:30;
  transition: opacity .18s ease, transform .18s ease;
}
.header.hidden-ui{
  opacity:0;
  transform: translateY(-6px);
  pointer-events:none;
}
.logo{
  width: clamp(120px, 24vw, 190px);
  height:auto;
  filter: drop-shadow(0 12px 22px rgba(0,0,0,.22));
}

/* Mini info */
.mini-info{
  position:fixed;
  top: clamp(72px, 10vh, 120px);
  left: clamp(12px, 4vw, 32px);
  right: clamp(12px, 4vw, 32px);
  max-width: 660px;
  z-index:20;

  padding: 12px 14px;
  border-radius: var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.11));
  border: 1px solid var(--stroke-soft);
  backdrop-filter: blur(14px);
  box-shadow: var(--shadow);
  overflow:hidden;
}

.mini-info::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius: inherit;
  pointer-events:none;
  background:
    radial-gradient(520px 220px at 14% 18%, rgba(255,255,255,.14), transparent 60%),
    linear-gradient(to bottom, rgba(0,0,0,.10), rgba(0,0,0,.04));
  opacity:.62;
}

.mini-top{
  position:relative;
  display:flex;
  justify-content: space-between;
  gap: 12px;
  align-items:flex-start;
}
.mini-title{
  font-size: clamp(1.12rem, 4.2vw, 1.95rem);
  font-weight: 600;
  line-height: 1.15;
  text-shadow: 0 2px 12px rgba(0,0,0,.22);
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
.mini-badges{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.badge{
  font-size:.82rem;
  padding: 6px 10px;
  border-radius:999px;
  background: rgba(255,255,255,.14);
  border: 1px solid rgba(255,255,255,.24);
  white-space:nowrap;
  backdrop-filter: blur(10px);
  color: rgba(255,255,255,.98);
}
.badge.season{
  background: rgba(255,215,0,.14);
  border-color: rgba(255,215,0,.22);
}
.mini-fact{
  position:relative;
  margin-top:8px;
  font-size:.96rem;
  text-shadow: 0 1px 10px rgba(0,0,0,.16);
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
.mini-desc{
  position:relative;
  margin-top:6px;
  color: var(--text-soft);
  line-height:1.48;
  font-weight:300;
  font-size:.96rem;
  text-shadow: 0 1px 10px rgba(0,0,0,.14);
  display:-webkit-box;
  -webkit-line-clamp:3;
  -webkit-box-orient:vertical;
  overflow:hidden;
}

/* Tap to start */
.tap-to-start{
  position:fixed;
  left:50%;
  transform: translateX(-50%);
  top: calc(50% - 20px);
  z-index:50;
  background: rgba(255,255,255,.18);
  border: 1px solid rgba(255,255,255,.30);
  padding: 10px 14px;
  border-radius:999px;
  backdrop-filter: blur(14px);
  box-shadow: 0 16px 40px rgba(0,0,0,.18);
  cursor:pointer;
  user-select:none;
}

/* Controls */
.controls{
  position:fixed;
  left: clamp(12px, 4vw, 32px);
  bottom: calc(var(--bar-h) + var(--safe-bottom) + 14px);
  z-index:25;
  display:flex;
  gap:10px;
}
.ctrl-btn{
  border:none;
  cursor:pointer;
  background: var(--btn);
  color: var(--white);
  padding: 10px 14px;
  border-radius: 14px;
  min-width: 54px;
  font-size: 1rem;
  box-shadow: 0 12px 28px rgba(0,0,0,.18);
  transition: transform .12s ease, background .12s ease;
  touch-action: manipulation;
  border: 1px solid rgba(255,255,255,.20);
  backdrop-filter: blur(14px);
}
.ctrl-btn:hover{
  background: var(--btn-hover);
  transform: translateY(-1px);
}
.ctrl-btn.secondary{ background: rgba(255,255,255,.12); }
.ctrl-btn.secondary:hover{ background: rgba(255,255,255,.18); }

/* Months bar */
.months-bar{
  position:fixed;
  left:0; right:0; bottom:0;
  height: calc(var(--bar-h) + var(--safe-bottom));
  padding: 10px 12px calc(10px + var(--safe-bottom)) 12px;

  background:
    linear-gradient(to top, rgba(0,0,0,.22), rgba(0,0,0,.08) 40%, rgba(0,0,0,0)),
    linear-gradient(to top, rgba(255,255,255,.14), rgba(255,255,255,.06));
  border-top: 1px solid rgba(255,255,255,.20);
  overflow:hidden;
  z-index:35;
  transition: opacity .18s ease, transform .18s ease;
  backdrop-filter: blur(16px);
}
.months-bar.hidden-ui{
  opacity:0;
  transform: translateY(12px);
  pointer-events:none;
}

.months-scroll{
  display:flex;
  gap:10px;
  overflow-x:auto;
  padding: 8px 0 10px 0;
  scrollbar-width:none;
  -webkit-overflow-scrolling:touch;
  scroll-behavior:smooth;
  scroll-snap-type: x mandatory;
  touch-action: pan-x;
}
.months-scroll::-webkit-scrollbar{ display:none; }

.month-btn{
  flex:0 0 auto;
  min-width:72px;
  padding: 12px 14px;
  border:none;
  border-radius:14px;
  background: rgba(255,255,255,.14);
  color: rgba(255,255,255,.96);
  font-weight:700;
  font-size:.98rem;
  cursor:pointer;
  scroll-snap-align:center;
  box-shadow: 0 10px 22px rgba(0,0,0,.12);
  transition: transform .12s ease, background .12s ease;
  border: 1px solid rgba(255,255,255,.22);
  backdrop-filter: blur(14px);
}
.month-btn:hover{
  background: rgba(255,255,255,.20);
  transform: translateY(-1px);
}
.month-btn.active{
  background: rgba(255,255,255,.22);
  border-color: rgba(255,255,255,.34);
  box-shadow: 0 12px 28px rgba(0,0,0,.16);
}

.scroll-hint{
  position: sticky;
  right:0;
  padding-left:14px;
  background: linear-gradient(to left, rgba(255,255,255,.18), transparent);
  display:flex;
  align-items:center;
  flex-shrink:0;
  transition: opacity .18s ease;
}
.months-scroll.scrolled-to-end .scroll-hint{ opacity:0; }

.scroll-arrow{
  width:22px; height:22px;
  color: rgba(255,255,255,.92);
  opacity:.80;
  animation:pulse 1.4s infinite;
}
@keyframes pulse{
  0%,100%{ transform:translateX(0); }
  50%{ transform:translateX(5px); }
}

.scroll-indicator{
  height:3px;
  background: rgba(255,255,255,.20);
  border-radius:999px;
  overflow:hidden;
}
.scroll-progress{
  height:100%;
  width:0%;
  background: var(--prog);
  transition: width .16s ease;
  box-shadow: 0 0 10px rgba(255,255,255,.14);
}

/* Cinema */
.fs-shell.cinema{ cursor:none; }

/* Cinema hint (always, but exit doesn't depend on it) */
.cinema-hint{
  position:fixed;
  left:50%;
  transform: translateX(-50%);
  bottom: calc(var(--safe-bottom) + 18px);
  z-index:70;

  background: rgba(255,255,255,.16);
  padding: 10px 14px;
  border-radius:999px;
  font-size:.95rem;
  border: 1px solid rgba(255,255,255,.26);
  backdrop-filter: blur(14px);
  user-select:none;
}

/* Video progress */
.video-progress-container{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  height:3px;
  background: rgba(255,255,255,0.20);
  z-index:10;
}
.video-progress{
  height:100%;
  background: var(--prog);
  transition: width 0.1s linear;
  box-shadow: 0 0 12px rgba(255,255,255,.16);
}

/* Map */
.map-slot{
  position:fixed;
  right: clamp(12px, 3vw, 22px);
  top: clamp(84px, 12vh, 146px);
  z-index:22;
}
.map-slot.cinema-hidden{
  opacity:0;
  pointer-events:none;
}

.kg-map{
  width: clamp(160px, 22vw, 250px);
  padding: 10px 10px 8px 10px;
  border-radius:16px;

  background: linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,.10));
  border: 1px solid rgba(255,255,255,.22);
  backdrop-filter: blur(14px);
  box-shadow: var(--shadow);
}
.kg-map-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:6px;
  gap:8px;
}
.kg-map-title{ font-weight:600; font-size:.9rem; opacity:.92; }

.kg-map-link{
  font-size:.85rem;
  color: rgba(255,255,255,.95);
  text-decoration:none;
  padding: 6px 10px;
  border-radius:12px;
  background: rgba(255,255,255,.14);
  border: 1px solid rgba(255,255,255,.22);
  white-space: nowrap;
}
.kg-map-link:hover{ background: rgba(255,255,255,.20); }

.kg-map-svg{ width:100%; height:auto; }

.kg-regions path{
  cursor:pointer;
  outline:none;

  fill: rgba(255,255,255,.10);
  stroke: rgba(255,255,255,.20);
  stroke-width:1;

  transition: fill .12s ease, stroke .12s ease, filter .12s ease, transform .12s ease;
}
.kg-regions path:hover{
  fill: rgba(255,255,255,.16);
  stroke: rgba(255,255,255,.28);
  transform: translateY(-0.35px);
}
.kg-regions path:focus-visible{
  stroke: rgba(255,255,255,.48);
  stroke-width:1.6;
}

.kg-map[data-active="naryn"] #naryn,
.kg-map[data-active="issyk_kul"] #issyk_kul,
.kg-map[data-active="osh"] #osh,
.kg-map[data-active="jalal_abad"] #jalal_abad,  
.kg-map[data-active="talas"] #talas,
.kg-map[data-active="chui"] #chui,
.kg-map[data-active="batken"] #batken{
  fill: rgb(255, 255, 0);
  stroke: rgb(238, 255, 0);
  filter: drop-shadow(0 0 6px rgba(0, 0, 0, 0.655));
  transform: translateY(-0.4px);
}

.kg-map-active{
  margin-top: 6px;
  font-size: .82rem;
  opacity: .86;
}

/* Mobile */
@media (max-width: 680px){
  :root{ --bar-h: 94px; }

  .month-btn{ min-width:64px; font-size:.92rem; padding: 12px 12px; }
  .controls{ left:12px; bottom: calc(var(--bar-h) + var(--safe-bottom) + 14px); gap:8px; }
  .ctrl-btn{ min-width: 48px; padding: 10px 12px; }
  .mini-info{ max-width:none; }

  .map-slot{
    top:auto;
    bottom: calc(var(--bar-h) + var(--safe-bottom) + 14px);
    right: 12px;
  }
  .kg-map{ width: 184px; max-width: 184px; }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{
    animation-duration: .001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: .001ms !important;
    scroll-behavior: auto !important;
  }
}